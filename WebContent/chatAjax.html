<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<script src="assets/jQuery/2.x/jquery-2.1.4.min.js"></script>
	</head>
	<body>
		<div class="chat_dialog" style="width: 60%;height: 500px;margin: 0 auto;background-color: #CFCDCF;">
			<div class="show_chatInfo" style="width: 100%;height: 90%;">
				<span class="info_item">load...</span>
			</div>
			<div class="send_message" style="width: 100%;height: 10%;">
				<input type="text" name="username" id="username" placeholder="请输入用户名字" value=""/>
				<input type="text" name="message" id="message" placeholder="" value=""/>
				<button type="button" value="发送" id="send_button">发送</button>
			</div>
		</div>
	</body>
	<script>
		
		setInterval(getInfo, 2000);
	
		$(document).ready(function() {
				$("#send_button").bind('click', function() {
					$.post("/HealthyRoom1.0/receiveChat",{
						//secondId:<?php echo secondId; ?>
						message: $("#message").val().trim(),
						username: $("#username").val().trim()
					}, function(data, textStatus) {
						//alert(data);
						var username = data.username;
						var message = data.message;
						var textHtml = "<div class='username_detail'><span>" + username + ":</span><span class='message_detail'>" + message + "</span></div>";
						$(".info_item").append(textHtml);//将返回的数据添加到页面上
					}, "json")
				});
		});
		function getInfo() {
			$.post("/receiveChat", {}, function(data, textStatus) {
				var username = data.username;
				var message = data.message;
				var textHtml;
				alert(username);
				if(username===null || message===null)
					textHtml = "";
				else
					textHtml = "<div class='username_detail'><span>" + username + ":</span><span class='message_detail'>" + message + "</span></div>";
				$(".info_item").append(textHtml);//将返回的数据添加到页面上
			}, "json");
		}
	</script>
</html>
